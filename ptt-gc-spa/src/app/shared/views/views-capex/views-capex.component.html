<div class="form-group row mt-5">
  <div class="col-md-12">
    <h3>CAPEX Infomation</h3>
    <hr />
  </div>
</div>
<div class="container my-1">
  <div class="row">
    <div class="col-md-12">
      <div class="card text card-initiative">
        <app-initiative-information [id]="id"></app-initiative-information>

        <form *ngIf="Initiative_tmp" [formGroup]="InitiativeDetailForm">
          <div class="row mt-5">
            <div class="col-md-12">
              <h4>Initiative Detail</h4>
              <hr />
            </div>
            <div class="col-md-6">
              <label for="StartingDate">
                Starting Date <span class="text-danger">*</span> :
              </label>

              <div class="input-group">
                <input
                  formControlName="StartingDate"
                  class="form-control"
                  type="text"
                  readonly
                />

                <div class="input-group-append">
                  <i class="far fa-calendar right-icon mt-2"></i>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label for="ProjecctComRun">
                Project Commercial Run <span class="text-danger">*</span> :
              </label>
              <div class="input-group">
                <input
                  formControlName="ProjecctComRun"
                  type="text"
                  class="form-control"
                  readonly
                />

                <div class="input-group-append">
                  <i class="far fa-calendar right-icon mt-2"></i>
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-6">
              <label for="RequestIniNoDate">
                Request Project No. Date (Budget Start Date)
                <span class="text-danger">*</span> :
              </label>
              <div class="input-group">
                <input
                  formControlName="RequestIniNoDate"
                  type="text"
                  class="form-control"
                  readonly
                />

                <div class="input-group-append">
                  <i class="far fa-calendar right-icon mt-2"></i>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label for="finishDate">
                Project Execution Period <span class="text-danger">*</span> :
              </label>
              <div class="row">
                <div class="col-md-3">
                  <input
                    type="text"
                    class="form-control"
                    value="ProjectExePeriodYear"
                    formControlName="ProjectExePeriodYear"
                    readonly
                  />
                </div>
                <div class="col-md-3 p-2">
                  <span>Year</span>
                </div>
                <div class="col-md-3">
                  <input
                    type="text"
                    class="form-control"
                    value="ProjectExePeriodMonth"
                    formControlName="ProjectExePeriodMonth"
                    readonly
                  />
                </div>
                <div class="col-md-3 p-2">
                  <span>Month</span>
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-6">
              <label for="CostCenterOfVP">
                Cost Center of VP (Budget Owner)
                <span class="text-danger">*</span> :
              </label>

              <ng-select
                formControlName="CostCenterOfVP"
                [items]="owners"
                [readonly]="true"
              >
              </ng-select>
            </div>
            <div class="col-md-6">
              <label for="finishDate">
                Code Of Cost Center of VP (Budget Owner)
                <span class="text-danger">*</span> :
              </label>
              <input
                formControlName="CodeCostCenterOfVP"
                type="text"
                name="CodeCostCenterOfVP"
                class="form-control"
                placeholder=""
                readonly
              />
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-6">
              <label for="finishDate">
                Project Cost (MTHB) <span class="text-danger">*</span> :
              </label>
              <input
                formControlName="ProjectCost"
                #ProjectCost_tmp
                (blur)="setProjectCost(ProjectCost_tmp.value)"
                type="text"
                name="ProjectCost"
                class="form-control"
                placeholder=""
                step="0.01"
                placeholder="0.00"
                mask="separator.2"
                thousandSeparator=","
                readonly
              />
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-12" *ngIf="RemarkShow == true">
              <label for="finishDate">
                Reason of changing Project Cost
                <span class="text-danger">*</span>
                :
              </label>
              <textarea
                class="form-control"
                id="ReasonOfChanging"
                name="ReasonOfChanging"
                formControlName="ReasonOfChanging"
                readonly
              >
              </textarea>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-2">
              <label for="BudgetForm">
                Budget Period <span class="text-danger">*</span> :
              </label>
            </div>
            <div class="col-md-10">
              <div class="custom-control custom-radio custom-control-inline">
                <input
                  id="Annual"
                  value="Annual"
                  class="custom-control-input"
                  type="radio"
                  name="BudgetForm"
                  formControlName="BudgetForm"
                  (change)="OnChangeRequestOPEX($event.target.value)"
                  disabled
                />
                <label class="custom-control-label" for="Annual">
                  Annual ({{ year_next }})
                </label>
              </div>
            </div>
            <div class="col-md-2"></div>
            <div class="col-md-10 mt-1">
              <div class="custom-control custom-radio custom-control-inline">
                <input
                  id="MidYear"
                  value="Mid Year"
                  class="custom-control-input"
                  type="radio"
                  name="BudgetForm"
                  formControlName="BudgetForm"
                  (change)="OnChangeRequestOPEX($event.target.value)"
                  disabled
                />
                <label class="custom-control-label" for="MidYear">
                  Mid Year ({{ year_now }})
                </label>
              </div>
            </div>
            <div class="col-md-2"></div>
            <div class="col-md-10 mt-2">
              <div class="custom-control custom-radio custom-control-inline">
                <input
                  id="Between"
                  value="Current year"
                  class="custom-control-input"
                  type="radio"
                  name="BudgetForm"
                  formControlName="BudgetForm"
                  (change)="OnChangeRequestOPEX($event.target.value)"
                  disabled
                />
                <label class="custom-control-label" for="Between">
                  Current year
                </label>
              </div>
            </div>

            <div class="row mt-3 sub-Between" *ngIf="showContingency">
              <div class="col-md-12">
                <div class="custom-control custom-radio custom-control-inline">
                  <input
                    id="Contingency"
                    value="Contingency"
                    class="custom-control-input"
                    type="radio"
                    name="BetweenYear"
                    formControlName="BetweenYear"
                    (change)="OnChangeBetweenYear($event.target.value)"
                    disabled
                  />
                  <label class="custom-control-label" for="Contingency">
                    Contingency ({{ year_now }})
                  </label>
                </div>
              </div>
              <div class="col-md-12 mt-2">
                <div class="custom-control custom-radio custom-control-inline">
                  <input
                    id="Transfer"
                    value="Transfer"
                    class="custom-control-input"
                    type="radio"
                    name="BetweenYear"
                    formControlName="BetweenYear"
                    (change)="OnChangeBetweenYear($event.target.value)"
                    disabled
                  />
                  <label class="custom-control-label" for="Transfer">
                    Transfer ({{ year_now }})
                  </label>
                </div>
              </div>
            </div>

            <div class="col-md-12 sub-Transfer">
              <div *ngIf="inshow">
                <label for="TransferForm">
                  Transfer Form <span class="text-danger">*</span> :
                </label>
                <div class="input-group" id="Form" style="width: 50%;">
                  <select
                    formControlName="TransferForm"
                    name="TransferForm"
                    value="TransferForm"
                    class="form-control"
                    (change)="transfer($event.target.value)"
                    disabled
                  >
                    <option value="" selected disabled> Choose...</option>
                    <option value="OPEX">OPEX</option>
                    <option value="RMA">RMA</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="row sub-Between" *ngIf="showContingency">
              <!-- <div class="col-md-12">
                  <div class="custom-control custom-radio custom-control-inline">
                    <input id="BOD" value="BOD Approval on" class="custom-control-input" type="radio" name="BetweenYear"
                      formControlName="BetweenYear" (change)="OnChangeBetweenYear($event.target.value)" />
                    <label class="custom-control-label" for="BOD">
                      BOD Approval on
                    </label>
                  </div>
                </div> -->
              <div class="col-md-12 mt-2">
                <div class="custom-control custom-radio custom-control-inline">
                  <input
                    id="Pool"
                    value="Pool Budget"
                    class="custom-control-input"
                    type="radio"
                    name="BetweenYear"
                    formControlName="BetweenYear"
                    disabled
                  />
                  <label class="custom-control-label" for="Pool">
                    Pool Budget ({{ year_now }})
                  </label>
                </div>
              </div>
            </div>

            <div class="col-md-12 mt-3 sub-Transfer">
              <div *ngIf="ferPool">
                <label for="TransferForm">
                  Pool Budget Form <span class="text-danger">*</span> :
                </label>
                <div class="input-group" id="Form" style="width: 50%;">
                  <select
                    class="form-control"
                    formControlName="PoolBudgetForm"
                    name="PoolBudgetForm"
                    value="PoolBudgetForm"
                    (change)="pool($event.target.value)"
                    disabled
                  >
                    <option value="" selected disabled> Choose...</option>
                    <option value="MAX">MAX</option>
                    <option value="DIM">DIM</option>
                    <option value="PIM">PIM</option>
                    <option value="ER">ER</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Start Table -->
          <!---->
          <div class="row mt-5">
            <div class="col-md-12">
              <h4>Annual Investment Plan</h4>
              <hr />
            </div>
          </div>

          <form *ngIf="AnnualForm" [formGroup]="AnnualForm">
            <div class="container">
              <div class="row">
                <div class="col-md-12">
                  <div class="card text card-initiative">
                    <div class="form-initiative">
                      <div class="form-row align-items-center">
                        <div class="w-100">
                          <div class="table-responsive">
                            <table class="table table-bordered">
                              <thead class="text-center bg-light">
                                <tr>
                                  <th width="200px">Investment Plan</th>
                                  <th width="100px">Overall</th>
                                  <th
                                    width="100px"
                                    *ngFor="
                                      let column of YearTable;
                                      let i = index
                                    "
                                  >
                                    {{ column.columnname }}
                                  </th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr
                                  formArrayName="annualForm_list"
                                  *ngFor="
                                    let cd of annualForm_.controls;
                                    let i = index
                                  "
                                >
                                  <td class="text-center" [formGroupName]="i">
                                    <!-- <select class="form-control">
                                        <option>{{i.currencyTitle}}</option>
                                      </select> -->
                                    <select
                                      class="form-control"
                                      *ngIf="i == 0"
                                      formControlName="currencyTitle"
                                      (change)="
                                        changeRate($event.target.value, i)
                                      "
                                      disabled="flagFirst_row"
                                    >
                                      <option
                                        *ngFor="let t of typeTransaction"
                                        [value]="t.code"
                                        >{{ t.chooes }}</option
                                      >
                                    </select>
                                    <select
                                      class="form-control"
                                      *ngIf="i != 0"
                                      formControlName="currencyTitle"
                                     readonly
                                    >
                                      <option
                                        *ngFor="let t of typeTransaction"
                                        [value]="t.code"
                                        >{{ t.chooes }}</option
                                      >
                                    </select>
                                    <label
                                      class="mt-3"
                                      for="finishDate"
                                      *ngIf="i != 0"
                                    >
                                      FX
                                    </label>
                                    <input
                                      formControlName="fx"
                                      (change)="ChangingValue_fx(i)"
                                      class="form-control"
                                      type="text"
                                      *ngIf="i != 0"
                                     readonly
                                    />

                                    <button
                                      [formGroupName]="i"
                                      *ngIf="i != 0"
                                      class="btn btn-danger btn-sm mt-3 disabled"
                                    >
                                      <i class="fas fa-trash-alt"></i>
                                    </button>
                                  </td>
                                  <td [formGroupName]="i">
                                    <input
                                      class="form-control"
                                      type="text"
                                      formControlName="overall"
                                      mask="separator.2"
                                      step="0.01"
                                      thousandSeparator=","
                                      readonly
                                    />
                                  </td>
                                  <td
                                    [formGroupName]="i"
                                    *ngFor="
                                      let column of YearTable;
                                      let j = index
                                    "
                                  >
                                    <input
                                      class="form-control"
                                      (change)="
                                        ChangingValue($event.target.value)
                                      "
                                      formControlName="y{{ j + 1 }}"
                                      mask="separator.2"
                                      step="0.01"
                                      thousandSeparator=","
                                      readonly
                                    />
                                  </td>
                                </tr>
                              </tbody>
                              <tfoot>
                                <tr>
                                  <td>
                                    <label for="finishDate">
                                      Total Million Baht
                                    </label>
                                  </td>
                                  <td>
                                    <input
                                      class="form-control"
                                      type="text"
                                      mask="separator.2"
                                      thousandSeparator=","
                                      formControlName="AnnualTotal_overall"
                                      readonly
                                    />
                                  </td>
                                  <td
                                    *ngFor="
                                      let column of YearTable;
                                      let j = index
                                    "
                                  >
                                    <input
                                      class="form-control"
                                      type="text"
                                      mask="separator.2"
                                      thousandSeparator=","
                                      formControlName="AnnualTotal{{ j + 1 }}"
                                      readonly
                                    />
                                  </td>
                                </tr>
                              </tfoot>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- <button
              type="button"
              class="btn btn-primary mt-3"
              (click)="addSellingPoint()"
            >
              Add New
            </button> -->
          </form>

          <div *ngFor="let ym of year_m; let i = index">
            <form *ngIf="i == 0" [formGroup]="monthForm0">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M1"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M1">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_1"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody
                                  *ngFor="
                                    let cd of monthForm0_.controls;
                                    let j = index
                                  "
                                >
                                  <tr formArrayName="monthForm_list">
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <td
                                      [formGroupName]="j"
                                      *ngFor="
                                        let column of monthList_1;
                                        let jj = index
                                      "
                                    >
                                      <input
                                        *ngIf="
                                          cd.get('flag_alert').value == true
                                        "
                                        class="form-control ; border-danger"
                                        formControlName="m{{ jj + 1 }}"
                                        (change)="
                                          ChangingValue_month_table1(ym)
                                        "
                                        (keypress)="keyPress($event)"
                                        type="text"
                                        pattern="[0-9]*"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                      <input
                                        *ngIf="
                                          cd.get('flag_alert').value == false
                                        "
                                        class="form-control"
                                        formControlName="m{{ jj + 1 }}"
                                        (change)="
                                          ChangingValue_month_table1(ym)
                                        "
                                        (keypress)="keyPress($event)"
                                        type="text"
                                        pattern="[0-9]*"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        [readonly]="true"
                                        formControlName="monthTotal_overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="monthTotal{{ j + 1 }}"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        [readonly]="true"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 1" [formGroup]="monthForm1">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M2"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M2">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>

                                    <ng-container *ngIf="i != diffYear">
                                      <th
                                        width="180px"
                                        *ngFor="let m of monthList_x"
                                      >
                                        {{ m.columnname }}
                                      </th>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <th
                                        width="180px"
                                        *ngFor="let m of monthList_last"
                                      >
                                        {{ m.columnname }}
                                      </th>
                                    </ng-container>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm1_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly="true"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        [readonly]="true"
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table2(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table2(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table2(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table2(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="monthTotal_overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        [readonly]="true"
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="monthTotal{{ j + 1 }}"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        [readonly]="true"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 2" [formGroup]="monthForm2">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M3"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M3">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm2_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        [readonly]="true"
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table3(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          [readonly]="true"
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table3(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table3(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table3(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="monthTotal_overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        [readonly]="true"
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="monthTotal{{ j + 1 }}"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        [readonly]="true"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 3" [formGroup]="monthForm3">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M4"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M4">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm3_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table4(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table4(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table4(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table4(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal_overall"
                                        readonly
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal{{ j + 1 }}"
                                        readonly
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 4" [formGroup]="monthForm4">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M5"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M5">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm4_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table5(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table5(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table5(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table5(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal_overall"
                                        readonly
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal{{ j + 1 }}"
                                        [readonly]="true"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 5" [formGroup]="monthForm5">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M6"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M6">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm5_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table6(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table6(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table6(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table6(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal_overall"
                                        [readonly]="true"
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal{{ j + 1 }}"
                                        [readonly]="true"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 6" [formGroup]="monthForm6">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M7"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M7">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm6_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table7(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table7(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table7(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table7(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal_overall"
                                        readonly
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal{{ j + 1 }}"
                                        [readonly]="true"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 7" [formGroup]="monthForm7">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M8"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M8">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm7_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table8(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table8(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table8(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table8(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal_overall"
                                        [readonly]="true"
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal{{ j + 1 }}"
                                        [readonly]="true"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 8" [formGroup]="monthForm8">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M9"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M9">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm8_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>
                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table9(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table9(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table9(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table9(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        [readonly]="true"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal{{ j + 1 }}"
                                      />
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        [readonly]="true"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal_overall"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>

            <form *ngIf="i == 9" [formGroup]="monthForm9">
              <div class="row mt-5">
                <div class="col-md-11">
                  <h4>Monthly Investment Plan ({{ ym }})</h4>
                  <hr />
                </div>
                <div class="col-md-1">
                  <button
                    class="btn btn-info"
                    data-toggle="collapse"
                    data-target="#M10"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="container collapse" id="M10">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card text card-initiative">
                      <div class="form-initiative">
                        <div class="form-row align-items-center">
                          <div class="w-100">
                            <div class="table-responsive">
                              <table class="table table-bordered">
                                <thead class="text-center bg-light">
                                  <tr>
                                    <th width="200px">Investment Plan</th>
                                    <th width="180px">Overall</th>
                                    <th
                                      width="180px"
                                      *ngFor="let m of monthList_x"
                                    >
                                      {{ m.columnname }}
                                    </th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    formArrayName="monthForm_list"
                                    *ngFor="
                                      let cd of monthForm9_.controls;
                                      let j = index
                                    "
                                  >
                                    <td [formGroupName]="j">
                                      <select
                                        class="form-control"
                                        formControlName="currencyTitle"
                                        disabled="flagFirst_row"
                                      >
                                        <option
                                          *ngFor="
                                            let t of typeTransaction_month
                                          "
                                          [value]="t.code"
                                          >{{ t.chooes }}
                                        </option>
                                      </select>
                                      <label
                                        class="mt-3"
                                        for="finishDate"
                                        *ngIf="j != 0"
                                      >
                                        FX
                                      </label>
                                      <input
                                        formControlName="fx"
                                        class="form-control"
                                        type="text"
                                        *ngIf="j != 0"
                                        readonly
                                      />
                                    </td>

                                    <td [formGroupName]="j">
                                      <input
                                        class="form-control"
                                        type="text"
                                        formControlName="overall"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        readonly
                                      />
                                    </td>
                                    <ng-container *ngIf="i != diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_x;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table10(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table10(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="i == diffYear">
                                      <td
                                        [formGroupName]="j"
                                        *ngFor="
                                          let column of monthList_last;
                                          let jj = index
                                        "
                                      >
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == true
                                          "
                                          class="form-control ; border-danger"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table10(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="test"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                        <input
                                          *ngIf="
                                            cd.get('flag_alert').value == false
                                          "
                                          class="form-control"
                                          formControlName="m{{ jj + 1 }}"
                                          (change)="
                                            ChangingValue_month_table10(ym)
                                          "
                                          (keypress)="keyPress($event)"
                                          type="text"
                                          pattern="[0-9]*"
                                          mask="separator.2"
                                          thousandSeparator=","
                                          readonly
                                        />
                                      </td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                                <tfoot>
                                  <tr>
                                    <td>
                                      <label for="finishDate">
                                        Total Baht
                                      </label>
                                    </td>
                                    <td>
                                      <input
                                        class="form-control"
                                        type="text"
                                        [readonly]="true"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal_overall"
                                      />
                                    </td>
                                    <td
                                      *ngFor="
                                        let column of monthList_1;
                                        let j = index
                                      "
                                    >
                                      <input
                                        class="form-control"
                                        type="text"
                                        [readonly]="true"
                                        mask="separator.2"
                                        thousandSeparator=","
                                        formControlName="monthTotal{{ j + 1 }}"
                                      />
                                    </td>
                                  </tr>
                                </tfoot>
                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>

          <!-- End Table -->
        </form>

        <!-- <br />
        <br />
        <br />
        <div class="row mt-5">
          <div class="col-md-12">
            <button class="btn btn-success">Attach files/View files</button>
          </div>
        </div>

        <div class="row mt-5">
          <div class="col-sm-12 col-md-6">
            <span>Total Million Baht </span>
            <select class="form-control mt-2">
              <option value="Million Baht">Choose ...</option>
              <option></option>
            </select>
          </div>
        </div> -->
      </div>
    </div>
  </div>
</div>
